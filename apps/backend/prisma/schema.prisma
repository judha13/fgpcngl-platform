generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  shadowDatabaseUrl = env("DATABASE_SHADOW_URL") 
}

model Member {
  id         String      @id @default(uuid()) @db.Uuid
  name       String
  email      String   @unique
  phone      String?
  role       String?  @default("Member")
  join_date  DateTime @default(now()) @map("join_date")
  status     String?  @default("active")
  created_at DateTime @default(now()) @map("created_at")
  updated_at DateTime @updatedAt @map("updated_at")

  @@map("members")
}

model Event {
  id               Int    @id @default(autoincrement())
  title            String
  description      String?
  event_date       DateTime  @map("event_date")
  event_time       DateTime? @map("event_time")
  location         String?
  live_stream_url  String?
  registration_url String?
  cover_image      String?
  thumbnail_image  String?
  status           String?   @default("ACTIVE")
  attendees        Int?      @default(0)
  created_at       DateTime  @default(now()) @map("created_at")
  updated_at       DateTime  @updatedAt @map("updated_at")
  deleted_at       DateTime? @map("deleted_at")
  created_by       Int?      @map("created_by")
  updated_by       Int?      @map("updated_by")

  images EventImage[]

  @@map("events")
}

model EventImage {
  id        Int   @id @default(autoincrement())
  eventId   Int   
  year      Int
  imagePath String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  event Event @relation(fields: [eventId], references: [id], onDelete: Cascade)

  @@map("event_images")
}

enum UserRolesEnum {
  ADMIN
  MODERATOR
}

model Users {
  userId         String         @id @default(uuid()) @db.Uuid
  email          String?        @unique
  phoneNumber    BigInt?        @unique
  hash           String?
  role           UserRolesEnum?
  activeToken    String?
  tokenExpiresAt DateTime?      @map("token_expires_at")
  created_at     DateTime       @default(now()) @map("created_at")
  updated_at     DateTime       @updatedAt @map("updated_at")
  created_by     String?        @map("created_by")

  @@map("users")
}
